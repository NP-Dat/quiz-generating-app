[
  {
    "question": "What is the primary purpose of shellcode in a buffer overflow exploit?",
    "answers": [
      "To inspect program logs after an overflow",
      "To execute attacker-supplied code (e.g., spawn a shell) when control flow is redirected",
      "To increase stack size for the process",
      "To patch the program binary on disk"
    ],
    "correct_answer": 1
  },
  {
    "question": "Which command is commonly used to run a command as the superuser on modern Linux systems?",
    "answers": ["su -", "sudo <command>", "runas /user:root", "setuid <command>"],
    "correct_answer": 1
  },
  {
    "question": "If a program relies on PATH instead of a full path, which vulnerability can this introduce?",
    "answers": [
      "An attacker can inject a malicious binary earlier in PATH and have it executed",
      "It disables execve() security checks",
      "It causes all binaries to run as root",
      "It prevents dynamic linking"
    ],
    "correct_answer": 0
  },
  {
    "question": "Which command shows both the effective UID (EUID) and real UID (RUID) of the current user?",
    "answers": ["whoami", "id", "ps -ef", "groups"],
    "correct_answer": 1
  },
  {
    "question": "Which mechanism is typically used to prevent unauthorized access to a system resource?",
    "answers": ["Access control (e.g., ACLs, permissions, RBAC)", "Disabling networking", "Increasing umask globally", "Changing the kernel"],
    "correct_answer": 0
  },
  {
    "question": "What vulnerability results from writing more data into a buffer than it can hold?",
    "answers": ["Race condition", "Buffer overflow", "Format string bug", "Privilege leaking"],
    "correct_answer": 1
  },
  {
    "question": "What is the purpose of the Set-UID bit on an executable?",
    "answers": [
      "Allow the binary to run with the file owner's privileges (often root) regardless of who runs it",
      "Force the program to run in a chroot",
      "Only allow execution during business hours",
      "Mark the file as immutable"
    ],
    "correct_answer": 0
  },
  {
    "question": "Which function-family choice is safer to avoid classic stack-based buffer overflows when invoking other programs?",
    "answers": ["system()", "execve() with explicit arguments", "popen() with shell", "sprintf() into fixed buffers"],
    "correct_answer": 1
  },
  {
    "question": "How does ASLR (Address Space Layout Randomization) impact buffer overflow exploitation?",
    "answers": [
      "It randomizes memory locations making it harder to predict return addresses for injected shellcode",
      "It prevents any stack-based writes",
      "It disables execve() for non-root users",
      "It forces all stacks to be non-executable"
    ],
    "correct_answer": 0
  },
  {
    "question": "An organization that needs data protection and secure access control should deploy which combination of mechanisms?",
    "answers": [
      "Encryption at rest/in transit, MFA authentication, role-based access control, and auditing/logging",
      "Only stronger firewalls and port blocking",
      "Umask changes and larger swap space",
      "Frequent kernel recompiles"
    ],
    "correct_answer": 0
  },
  {
    "question": "A Denial of Service (DoS) attack primarily violates which part of the CIA triad?",
    "answers": ["Confidentiality", "Integrity", "Availability", "Authentication"],
    "correct_answer": 2
  },
  {
    "question": "If logging is poor, what do you typically need to improve to make logs useful for security?",
    "answers": [
      "Centralized log collection, consistent timestamps, proper retention and alerting/analysis",
      "Disable logging to save disk",
      "Only keep logs locally without rotation",
      "Obfuscate log messages for privacy"
    ],
    "correct_answer": 0
  },
  {
    "question": "Which characteristic best describes multi-factor authentication (MFA)?",
    "answers": [
      "Using two or more independent authentication categories (something you know, have, or are)",
      "Using multiple passwords at once",
      "Authenticating from multiple networks simultaneously",
      "Combining username and password in one field"
    ],
    "correct_answer": 0
  },
  {
    "question": "Which libc function can be used in a return-to-libc style exploit to run /bin/bash?",
    "answers": ["strcpy()", "system(\"/bin/bash\")", "malloc()", "opendir()"],
    "correct_answer": 1
  },
  {
    "question": "What does StackGuard (canary) detect during function return processing?",
    "answers": [
      "Whether the stack canary value was overwritten (indicating a stack buffer overflow)",
      "If the heap was corrupted by a format string",
      "If PATH has been modified",
      "If ASLR is enabled"
    ],
    "correct_answer": 0
  },
  {
    "question": "If you detect unauthorized modifications in stored data, what should you do first?",
    "answers": [
      "Preserve evidence (logs, snapshots), isolate affected systems, then perform integrity checks and forensic analysis",
      "Immediately delete the modified files",
      "Restart the system to clear memory",
      "Reassign all user passwords the next day"
    ],
    "correct_answer": 0
  },
  {
    "question": "Which type of attack observes communications but does not alter them?",
    "answers": ["Active attack", "Passive attack", "Privilege escalation", "Buffer overflow"],
    "correct_answer": 1
  },
  {
    "question": "What is a primary risk when using Set-UID programs?",
    "answers": [
      "A coding flaw can be exploited to gain the file owner’s (often root) privileges via user-controlled inputs",
      "They always run only as the invoking user",
      "They restrict network access",
      "They remove the executable bit"
    ],
    "correct_answer": 0
  },
  {
    "question": "If an organization needs detailed records of actions for later analysis, which security process is most relevant?",
    "answers": ["Access control", "Auditing and logging", "Change management", "Patching schedule"],
    "correct_answer": 1
  },
  {
    "question": "What is the purpose of the umask value in Linux?",
    "answers": [
      "Define default permission bits removed from newly created files and directories",
      "Set the maximum file size",
      "Specify the shell for new users",
      "Encrypt home directories"
    ],
    "correct_answer": 0
  },
  {
    "question": "Which of the following is an example of an active attack?",
    "answers": ["Traffic analysis", "Message modification (tampering)", "Passive eavesdropping", "Statistical observation"],
    "correct_answer": 1
  },
  {
    "question": "Which command prints environment variables to stdout in a shell?",
    "answers": ["env", "printenv", "Both env and printenv", "setfile"],
    "correct_answer": 2
  },
  {
    "question": "What is the purpose of NOPs (No-Operation instructions) in a buffer overflow exploit?",
    "answers": [
      "Create a NOP-sled to increase the chance of landing execution into shellcode when return address is approximate",
      "Avoid detection by StackGuard",
      "Mark the end of shellcode for strcpy()",
      "Increase buffer write speed"
    ],
    "correct_answer": 0
  },
  {
    "question": "What does non-repudiation provide in security?",
    "answers": [
      "Proof of origin and delivery so a sender cannot deny having sent a message",
      "Guarantee that data is always encrypted",
      "Automatic deletion after transmission",
      "Prevent anyone from reading a message"
    ],
    "correct_answer": 0
  },
  {
    "question": "Which file contains basic user account information such as login name and UID in Linux?",
    "answers": ["/etc/passwd", "/etc/shadow", "/etc/group", "/etc/sudoers"],
    "correct_answer": 0
  },
  {
    "question": "Which command is commonly used to add a new user on Debian/Ubuntu systems?",
    "answers": ["adduser", "useradd -m", "newuser", "mkpasswd"],
    "correct_answer": 0
  },
  {
    "question": "On a unix executable permission set like chmod 4755, what does the leading '4' (in octal) represent?",
    "answers": [
      "Set-UID bit — run with file owner's privileges",
      "Set-GID bit — run with group privileges",
      "Sticky bit — restrict deletion in shared dirs",
      "No special meaning"
    ],
    "correct_answer": 0
  },
  {
    "question": "Which of the following is an example of a passive attack?",
    "answers": ["Listening to network traffic (eavesdropping)", "Injecting commands over SSH", "Altering database records", "Fuzzing a service"],
    "correct_answer": 0
  },
  {
    "question": "Which process verifies 'they are who they claim to be'?",
    "answers": ["Identification", "Authentication", "Authorization", "Accounting"],
    "correct_answer": 1
  },
  {
    "question": "Which permission on a directory allows a user to create files inside it?",
    "answers": ["write (w)", "read (r)", "execute (x)", "sticky (t)"],
    "correct_answer": 0
  },
  {
    "question": "Why is a NOP-sled commonly used in exploitation?",
    "answers": [
      "It broadens the landing area for execution so precise address targeting is less critical",
      "It encrypts shellcode at runtime",
      "It prevents ASLR from working",
      "It increases stack protection"
    ],
    "correct_answer": 0
  },
  {
    "question": "Recording and storing events for later inspection is commonly called:",
    "answers": ["Auditing / logging", "Monitoring only", "Access control", "Encryption"],
    "correct_answer": 0
  },
  {
    "question": "Dynamic linking combined with Set-UID binaries introduces which risk?",
    "answers": [
      "Untrusted environment variables (LD_PRELOAD, LD_LIBRARY_PATH) could cause malicious libraries to load with elevated privileges",
      "It prevents the program from running",
      "It always forces static linking",
      "It hides logs from sysadmin"
    ],
    "correct_answer": 0
  },
  {
    "question": "Which measures help protect information under the CIA model?",
    "answers": [
      "Encryption (confidentiality), integrity checks (hashes/signatures), access control and redundancy (availability)",
      "Only stronger passwords",
      "Only network segmentation",
      "Only periodic reboots"
    ],
    "correct_answer": 0
  },
  {
    "question": "Which command sets the Set-UID bit using the symbolic permission form?",
    "answers": ["chmod u+s <file>", "chmod +s <file>", "chmod 777 <file>", "setfacl -m u::s <file>"],
    "correct_answer": 0
  },
  {
    "question": "How does Set-UID help maintain functionality while attempting security?",
    "answers": [
      "It allows specific programs to run with higher privileges needed for tasks while other processes/users remain unprivileged",
      "It elevates all user processes automatically",
      "It disables logging when running",
      "It prevents file deletion"
    ],
    "correct_answer": 0
  },
  {
    "question": "Which hardware/CPU feature enables a non-executable stack?",
    "answers": ["NX (No-eXecute) bit / DEP", "SSE instructions", "MMU swap", "SMT (Hyperthreading)"],
    "correct_answer": 0
  },
  {
    "question": "What does the read (r) permission on a file permit?",
    "answers": ["View the file contents", "Execute the file as a program", "Change file ownership", "Delete the file"],
    "correct_answer": 0
  },
  {
    "question": "Which difference between exec() and system() is security-relevant?",
    "answers": [
      "execve() runs a program directly with chosen arguments; system() invokes a shell which may interpret user data as commands (higher risk)",
      "execve() always runs as root; system() always runs as user",
      "execve() logs by default; system() is silent",
      "There is no difference"
    ],
    "correct_answer": 0
  },
  {
    "question": "Which command assigns fine-grained POSIX ACL permissions to a file or directory?",
    "answers": ["setfacl -m u:alice:rw <file>", "chmod 777 <file>", "chown alice <file>", "usermod -aG acl <file>"],
    "correct_answer": 0
  },
  {
    "question": "What does the POSIX capability CAP_NET_RAW allow?",
    "answers": [
      "Creation and use of raw network sockets (e.g., needed for ping or packet sniffing)",
      "Changing file ownership arbitrarily",
      "Overriding discretionary ACLs",
      "Access to /etc/shadow"
    ],
    "correct_answer": 0
  },
  {
    "question": "Why might someone call system(\"/bin/bash\") instead of injecting custom shellcode?",
    "answers": [
      "To reuse an existing high-level shell for command execution and avoid tricky architecture-specific shellcode issues",
      "Because system() is always faster",
      "To bypass all kernel protections",
      "To automatically drop privileges"
    ],
    "correct_answer": 0
  },
  {
    "question": "When a program calls another program without a full path, which environment variable is used to find it?",
    "answers": ["PATH", "LD_PRELOAD", "HOME", "SHELL"],
    "correct_answer": 0
  },
  {
    "question": "Does encryption protect against both passive and active attacks equally?",
    "answers": [
      "Encryption primarily protects confidentiality against passive eavesdropping, while integrity/authenticity measures are needed to defend active tampering",
      "Encryption makes systems immune to all attacks",
      "Encryption only protects the network layer",
      "Encryption prevents privilege escalation"
    ],
    "correct_answer": 0
  },
  {
    "question": "If a sensitive record is modified, which two CIA principles are violated?",
    "answers": ["Confidentiality and Availability", "Integrity and Confidentiality", "Integrity and Availability", "Authentication and Non-repudiation"],
    "correct_answer": 2
  },
  {
    "question": "Which command switches to another user interactively (prompting for that user's password)?",
    "answers": ["su - <user>", "sudo -u <user> <command>", "runuser", "setuser"],
    "correct_answer": 0
  },
  {
    "question": "Which command displays file permission bits and owner information for files in a directory?",
    "answers": ["ls -l", "stat", "getfacl", "ls -R"],
    "correct_answer": 0
  },
  {
    "question": "What is a key difference between a shell variable and an environment variable?",
    "answers": [
      "Shell variables are local to the shell and not inherited by children unless exported; environment variables are inherited by child processes",
      "Shell variables are stored in /etc/env only",
      "Environment variables cannot be changed at runtime",
      "Shell variables are only for root"
    ],
    "correct_answer": 0
  },
  {
    "question": "Which of these is commonly used in return-to-libc attacks?",
    "answers": ["Existing libc functions such as system(), execve(), and known libc addresses", "Custom kernel modules", "Set-UID directories", "Temporary files"],
    "correct_answer": 0
  },
  {
    "question": "Dynamic linking with Set-UID programs is risky because:",
    "answers": [
      "The dynamic linker's reliance on environment variables and search paths can allow untrusted libraries to be loaded with elevated privileges",
      "It always disables auditing",
      "It requires nightly reboots",
      "It prevents user logins"
    ],
    "correct_answer": 0
  },
  {
    "question": "Which security service enforces 'access only after verifying identity and origin of data'?",
    "answers": ["Authorization (after Authentication) and Data Origin Authentication", "Encryption", "Backup service", "Non-repudiation only"],
    "correct_answer": 0
  },
  {
    "question": "Which mitigation 'makes it harder to predict memory addresses' for exploits?",
    "answers": ["ASLR (address space layout randomization)", "StackGuard", "setuid bit", "sticky bit"],
    "correct_answer": 0
  },
  {
    "question": "Which function is the recommended safe choice to invoke an external program with explicit arguments?",
    "answers": ["execve() with full path and explicit argv/envp", "system()", "popen()", "execlp() without path"],
    "correct_answer": 0
  },
  {
    "question": "What is the main goal of Availability in the CIA triad?",
    "answers": [
      "Ensure authorized users can access resources when needed and systems run reliably",
      "Prevent disclosure of secrets",
      "Guarantee perfect integrity",
      "Record all changes"
    ],
    "correct_answer": 0
  },
  {
    "question": "What best describes the purpose of environment variables in Linux?",
    "answers": [
      "Provide dynamic, named values that affect process behavior and configuration (PATH, LANG, LD_* etc.)",
      "Store binary executables",
      "Enforce file permissions",
      "Provide VM memory layout"
    ],
    "correct_answer": 0
  },
  {
    "question": "Which environment variable is used to force loader behavior for dynamic libraries (and must be treated carefully)?",
    "answers": ["LD_PRELOAD", "HOME", "LOGNAME", "TMPDIR"],
    "correct_answer": 0
  },
  {
    "question": "What role does execve() play when exploited via shellcode?",
    "answers": [
      "It is often invoked in shellcode to execute /bin/sh (or similar) to give an attacker interactive control",
      "It defends against buffer overflows",
      "It disables all environment variables",
      "It resets UID to root always"
    ],
    "correct_answer": 0
  },
  {
    "question": "Which attack surface is often considered the weakest due to human factors?",
    "answers": ["Human (social engineering, phishing)", "Kernel", "Filesystem", "Network infrastructure"],
    "correct_answer": 0
  }
]
